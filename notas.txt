Instalar Sequelize (en tu contenedor api)

usando el compose donde api es la imagen de docker y el código está montado en ./api.

# Entrar al servicio api
docker compose exec api bash -lc "
  cd /workspace/api && \
  npm i sequelize mysql2 express-validator cors helmet && \
  npm i -D nodemon && \
  npm pkg set scripts.dev='nodemon server.js'
"


--probar
docker compose up -d
curl "http://localhost:3000/players?limit=5"
curl "http://localhost:3000/players?club=Barcelona&position=RW&year=2015&limit=10"
curl -I "http://localhost:3000/players/export.csv?club=Barcelona&year=2015"


Exportar XLSX (parte del enunciado)
Instalar exceljs:
docker compose exec api bash -lc "cd /workspace/api && npm i exceljs"


Índices recomendados (para mejorar los filtros)
docker compose exec db bash -lc '
mysql -uroot -p"$MYSQL_ROOT_PASSWORD" -D "$MYSQL_DATABASE" -e "
  CREATE INDEX IF NOT EXISTS idx_players_name ON players (long_name);
  CREATE INDEX IF NOT EXISTS idx_players_club ON players (club_name);
  CREATE INDEX IF NOT EXISTS idx_players_pos ON players (player_positions);
  CREATE INDEX IF NOT EXISTS idx_players_year ON players (fifa_version);
  CREATE INDEX IF NOT EXISTS idx_players_overall ON players (overall);
"'

# dentro del contenedor web
docker compose exec web bash -lc "cd /workspace/web \
  && npm i chart.js ng2-charts jwt-decode \
  && npm i @angular/forms @angular/router"



# reiniciar API
docker compose restart api
docker compose logs -f api

# públicas
curl -s http://localhost:3000/health
curl -s "http://localhost:3000/players?limit=5" | jq '.meta, .data[0]'

# login
TOKEN=$(curl -s -X POST http://localhost:3000/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@example.com","password":"admin123"}' | jq -r .token)

# protegidas
curl -I -H "Authorization: Bearer $TOKEN" \
  "http://localhost:3000/players/export.xlsx?club=Barcelona&year=2015"